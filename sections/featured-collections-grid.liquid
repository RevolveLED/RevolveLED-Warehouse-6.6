{{ 'featured-collections-grid.css' | asset_url | stylesheet_tag }}
{% comment %} {%- assign product = all_products[section.settings.product] -%} {% endcomment %}

{%- capture section_settings -%}
{% comment %} {
  "showShippingEstimator": false,
  "galleryTransitionEffect": {{ section.settings.carousel_effect | json }},
  "enableImageZoom": {{ section.settings.enable_image_zoom | json }},
  "zoomEffect": {{ section.settings.zoom_effect | json }},
  "infoOverflowScroll": false,
  "productOptions": {{ product.options | json | escape }},
  "isQuickView": false
} {% endcomment %}
{%- endcapture -%}

<section
  class="section index-section"
  data-section-id="{{ section.id }}"
  data-section-type="collections-grid"
  data-section-settings="{{ section_settings | escape_once }}"
>
  <div class="container">
    {%- if section.settings.title != blank -%}
      <header class="section__header index-section__header">
        <h2 class="section__title heading h3 index-section__title">{{ section.settings.title | escape }}</h2>
      </header>
    {%- endif -%}
  </div>

  <div class="container featured-collections-grid">
    {% for block in section.blocks %}
      {% liquid
        assign overlay_image = false
        if block.settings.overlay_image != blank
          assign overlay_image = true
        endif
      %}
      <div class="collections-grid-item overlay_image-{{ overlay_image }}" {{ block.shopify_attributes }}>
        <div class="collections-grid-item__content-wrapper">
          <a
            class="collections-grid-item__title"
            href="{{ block.settings.collection.url }}"
            aria-label="{{ block.settings.title | escape }}"
            title="{{ block.settings.title | escape }}"
          >
            {{ block.settings.title | escape }}
          </a>
          <a
            class="collections-grid-item__link-button"
            href="{{ block.settings.collection.url }}"
            aria-label="{{ block.settings.title | escape }}"
            title="{{ block.settings.title | escape }}"
          >
            {{ section.settings.block_button_label | escape }}
          </a>
        </div>
        <div class="collections-grid-item__image-wrapper">
          <a
            class="collections-grid-item__link"
            href="{{ block.settings.collection.url }}"
            aria-label="{{ block.settings.title | escape }}"
            title="{{ block.settings.title | escape }}"
          >
            {%- if block.settings.image != blank -%}
              {{
                block.settings.image
                | image_url: width: block.settings.image.width
                | image_tag: class: 'collections-grid-item__image', width: 200
              }}
            {%- endif -%}
          </a>
        </div>
        {%- if block.settings.overlay_image != blank -%}
          <div class="collections-grid-item__overlay-image">
            {{
              block.settings.overlay_image
              | image_url: width: block.settings.overlay_image.width
              | image_tag: class: 'collections-grid-item__overlay-image_img', loading: 'lazy'
            }}
          </div>
        {%- endif -%}
      </div>
    {% endfor %}
  </div>
</section>

{% schema %}
{
  "name": "Featured collections grid",
  "blocks": [
    {
      "type": "block",
      "name": "Block",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image",
          "info": "Size: 1:1"
        },
        {
          "type": "image_picker",
          "id": "overlay_image",
          "label": "Hover image"
        },
        {
          "type": "collection",
          "id": "collection",
          "label": "Collection"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title"
        }
      ]
    }
  ],
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Heading",
      "default": "Featured product"
    },
    {
      "type": "text",
      "id": "block_button_label",
      "label": "Button label",
      "default": "Shop Now"
    }
  ],
  "presets": [
    {
      "category": "Collection",
      "name": "Featured collections grid"
    }
  ]
}
{% endschema %}
